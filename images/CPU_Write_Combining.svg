<svg height="500" viewBox="0 0 617.78 372.18" width="1200" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<marker id="a" orient="auto" refX="0" refY="0" style="overflow:visible">
<path d="m5.77 0-8.65 5v-10z" style="fill:#008000;fill-rule:evenodd;stroke:#008000;stroke-width:1pt" transform="scale(-.4)"/>
</marker>
<marker id="b" orient="auto" refX="0" refY="0" style="overflow:visible">
<path d="m5.77 0-8.65 5v-10z" style="fill:#ff4500;fill-rule:evenodd;stroke:#ff4500;stroke-width:1pt" transform="scale(-.4)"/>
</marker>
<marker id="c" orient="auto" refX="0" refY="0" style="overflow:visible">
<path d="m5.77 0-8.65 5v-10z" style="fill:#ff4500;fill-rule:evenodd;stroke:#ff4500;stroke-width:1pt" transform="scale(-.4)"/>
</marker>
<marker id="d" orient="auto" refX="0" refY="0" style="overflow:visible">
<path d="m2.31 0-3.46 2v-4z" style="fill:#f00;fill-rule:evenodd;stroke:#f00;stroke-width:.4pt"/>
</marker>
<marker id="e" orient="auto" refX="0" refY="0" style="overflow:visible">
<path d="m2.31 0-3.46 2v-4z" style="fill:#008000;fill-rule:evenodd;stroke:#008000;stroke-width:.4pt"/>
</marker>
<marker id="f" orient="auto" refX="0" refY="0" style="overflow:visible">
<path d="m2.31 0-3.46 2v-4z" style="fill:#008000;fill-rule:evenodd;stroke:#008000;stroke-width:.4pt"/>
</marker>
<g style="fill:none">
<g style="stroke-width:1.1">
<path d="m86.07 18.26h108.17l-28.03 67.1h-109.64z" style="stroke:#696969;stroke-miterlimit:10"/>
<path d="m221.76 18.58h113.95v63.62h-113.95z" style="stroke:#00f"/>
<g style="stroke:#008000">
<path d="m228.66 204.38h95v55.03h-95z"/>
<path d="m228.45 217.79h94.91"/>
<path d="m228.45 231.75h94.91"/>
<path d="m228.63 245.71h94.91"/>
</g>
</g>
<g style="stroke:#32cd32;stroke-width:1.08;stroke-miterlimit:10">
<ellipse cx="275.82" cy="294.36" rx="34.8" ry="7.07"/>
<path d="m310.43 346.84c0 3.91-15.58 7.07-34.8 7.07s-34.8-3.17-34.8-7.07"/>
<path d="m241.02 347.59v-53.6m69.23 0v53.6"/>
</g>
</g>
<g style="stroke:#f00" transform="translate(111.88 -193.15)">
<g style="fill:none;stroke:#f00" transform="translate(37.03 30.14)">
<g style="stroke-width:1.07" transform="matrix(1.05 0 0 1 -10.17 0)">
<path d="m204.2 275.23h95v55.03h-95z"/>
<path d="m203.99 288.64h94.91"/>
<path d="m203.99 302.6h94.91"/>
<path d="m204.17 316.56h94.91"/>
</g>
<g style="stroke-width:1.1">
<path d="m229.22 330.31.17-55.55"/>
<path d="m255.06 330.1.17-55.55"/>
<path d="m280.04 330.53.17-55.55"/>
</g>
</g>
<g style="fill:none;stroke:#f00" transform="translate(-87.63 30.22)">
<g style="stroke-width:1.07" transform="matrix(1.05 0 0 1 -10.17 0)">
<path d="m204.2 275.23h95v55.03h-95z"/>
<path d="m203.99 288.64h94.91"/>
<path d="m203.99 302.6h94.91"/>
<path d="m204.17 316.56h94.91"/>
</g>
<g style="stroke-width:1.1">
<path d="m229.22 330.31.17-55.55"/>
<path d="m255.06 330.1.17-55.55"/>
<path d="m280.04 330.53.17-55.55"/>
</g>
</g>
<text style="font-size:10;font-family:Droid Sans;letter-spacing:-.5;word-spacing:0;stroke:none" x="-23.47" y="222.65">
<tspan x="-23.47" y="222.65">Assembler code</tspan>
</text>
<text style="font-size:10;font-family:Droid Sans;letter-spacing:-.5;word-spacing:0;stroke:none" x="-30.36" xml:space="preserve" y="245.91">
<tspan x="-30.36" y="245.91">mov  $66,  (%eax)</tspan>
<tspan x="-30.36" y="255.91"/>
<tspan x="-30.36" y="265.91">mov  $33,  8(%eaxx)</tspan>
</text>
<path d="m153.58 322.74-.45-79.38h-111.94" style="fill:none;stroke:#ff4500;marker-start:url(#b)"/>
<path d="m179.95 323.31-.52-60.55h-128.73" style="fill:none;stroke:#ff4500;marker-start:url(#c)"/>
<g style="font-size:10;font-family:Droid Sans;letter-spacing:-.5;word-spacing:0;stroke:none">
<text x="182.37" y="287.25">
<tspan x="182.37" y="287.25">Write combining : processor speculatively</tspan>
<tspan x="182.37" y="297.25">accumulates pipeline stores in the buffer</tspan>
</text>
<text x="272.8" y="329.45">
<tspan x="272.8" y="329.45">OK</tspan>
</text>
<text x="247.39" y="329.45">
<tspan x="247.39" y="329.45">KO</tspan>
</text>
<text x="322.77" y="329.15">
<tspan x="322.77" y="329.15">KO</tspan>
</text>
<text x="297.14" y="329.15">
<tspan x="297.14" y="329.15">OK</tspan>
</text>
<text x="347.73" y="324.28">
<tspan x="347.73" y="324.28">Bitset used to merge store and</tspan>
<tspan x="347.73" y="334.28">cache line</tspan>
</text>
<text x="62.65" y="329.45">
<tspan x="62.65" y="329.45">Add: 0xFFAA</tspan>
</text>
<text x="61.58" y="420.17">
<tspan x="61.58" y="420.17">Add: 0xBBAA</tspan>
</text>
<text x="202.4" y="508.44">
<tspan x="202.4" y="508.44">Add: 0xFFAA</tspan>
</text>
<text x="202.3" y="530.84">
<tspan x="202.3" y="530.84">Add: 0xBBAA</tspan>
</text>
</g>
<path d="m60.07 328.15-18.52 41.78 17.66 46.13" style="fill:none;stroke:#f00;marker-end:url(#d)"/>
<text style="font-size:10;font-family:Droid Sans;letter-spacing:-.5;word-spacing:0;stroke:none" x="-76.44" xml:space="preserve" y="362.61">
<tspan x="-76.44" y="362.61">Address not in the cache but </tspan>
<tspan x="-76.44" y="372.61">do not stall pipeline, buffer</tspan>
<tspan x="-76.44" y="382.61">stores while waiting for cache</tspan>
<tspan x="-76.44" y="392.61">line to be fetched</tspan>
</text>
<path d="m182.8 506v-87.91" style="fill:none;stroke:#008000;marker-end:url(#e)"/>
<text style="font-size:10;font-family:Droid Sans;letter-spacing:-.5;word-spacing:0;stroke:none" x="187.54" xml:space="preserve" y="467.68">
<tspan x="187.54" y="467.68">Fetch cache line from memory </tspan>
<tspan x="187.54" y="477.68">and merge with store buffer at retirement</tspan>
</text>
<path d="m167.3 415.72v-87.91" style="fill:none;stroke:#008000;stroke-width:1.5;marker-start:url(#a);marker-end:url(#f)"/>
<text style="font-size:10;font-family:Droid Sans;letter-spacing:-.5;word-spacing:0;stroke:none" x="169.45" y="381.56">
<tspan x="169.45" y="381.56">Merge two stores at once</tspan>
</text>
</g>
<path d="m309.58 190.13h72.68" style="fill:none;stroke:#000;stroke-width:.8"/>
<g style="font-size:10;font-family:Droid Sans;letter-spacing:-.5;word-spacing:0" transform="translate(5.72 -13.03)">
<text x="219.62" y="42.53">
<tspan x="219.62" y="42.53">CPU core</tspan>
</text>
<text x="182.16" y="269.9">
<tspan x="182.16" y="269.9">L1 cache</tspan>
</text>
<text x="167.52" y="178.18">
<tspan x="167.52" y="178.18">Store buffer</tspan>
</text>
<text x="456.47" y="176.46">
<tspan x="456.47" y="176.46">Valid data bitset</tspan>
</text>
</g>
<path d="m294.95 95.4h64.54" style="fill:none;stroke:#000;stroke-width:.8"/>
</svg>